syntax = "proto3";
package kvraft;

option go_package = "./kvpb";

enum Error {
    ERR_UNKNOWN = 0;

    OK = 1;
    ERR_NO_KEY = 2;
    ERR_VERSION = 3;

    ERR_MAYBE = 4;
    ERR_WRONG_LEADER = 5;
    ERR_WRONG_GROUP = 6;
}

message PutAppendArgs {
    string key = 1;
    string value = 2;
    string Op = 3;
    int64 clientId = 4;
    int64 requestId = 5;
}

message PutAppendReply {
    Error err = 1;
}
message GetArgs {
    string key = 1;
    int64 clientId = 2;
    int64 requestId = 3;
}

message GetReply {
    string value = 1;
    uint64 version = 2;
    Error err = 3;
}
message KVSnapshot {
    map<string, string> Data = 1;
    map<int64, int64> LastOperations = 2;
}

service RaftKV {
    rpc Get(GetArgs) returns (GetReply);
    rpc PutAppend(PutAppendArgs) returns (PutAppendReply);
}